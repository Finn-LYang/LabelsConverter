# ğŸ”„ Universal Label Converter (é€šç”¨æ ‡ç­¾è½¬æ¢å™¨)

Label Converter æ˜¯ä¸€ä¸ªè½»é‡çº§ä¸”é«˜åº¦å¯æ‰©å±•çš„ç›®æ ‡æ£€æµ‹æ•°æ®é›†æ ¼å¼è½¬æ¢å·¥å…·ã€‚å®ƒé‡‡ç”¨äº† **ä¸­é—´è¡¨ç¤ºï¼ˆIntermediate Representation, IRï¼‰** è®¾è®¡æ¨¡å¼ï¼Œå°†ä¸åŒæ ¼å¼ï¼ˆCOCO, YOLO, VOC, LabelMeï¼‰çš„æ•°æ®è½¬æ¢ä¸ºç»Ÿä¸€çš„æ•°æ®ç»“æ„ï¼Œå†å¯¼å‡ºä¸ºç›®æ ‡æ ¼å¼ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

* **å¤šæ ¼å¼æ”¯æŒ**ï¼šç›®å‰æ”¯æŒ COCO, YOLO (TXT), Pascal VOC (XML), LabelMe (JSON)ã€‚
* **ç»Ÿä¸€ä¸­é—´è¡¨ç¤º**ï¼šæ ¸å¿ƒé€»è¾‘åŸºäº `UnifiedLabel` å’Œ `BBox` æ•°æ®ç»“æ„ï¼Œè§£è€¦è¯»å–ä¸å†™å…¥ã€‚
* **æ’ä»¶åŒ–æ¶æ„**ï¼šé€šè¿‡ `registry.py` ç®¡ç†ï¼Œæ–°å¢ä¸€ç§æ ¼å¼åªéœ€ç»§æ‰¿åŸºç±»å¹¶æ³¨å†Œï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç ã€‚
* **å¯è§†åŒ–éªŒè¯**ï¼šå†…ç½®å¯è§†åŒ–å·¥å…·ï¼Œç¡®ä¿è½¬æ¢åçš„åæ ‡ï¼ˆå°¤å…¶æ˜¯å½’ä¸€åŒ–åæ ‡ï¼‰å‡†ç¡®æ— è¯¯ã€‚
* **ç±»åˆ«æ˜ å°„**ï¼šæ”¯æŒçµæ´»çš„ç±»åˆ« ID ä¸åç§°æ˜ å°„é…ç½®ã€‚

## ğŸ“‚ ä»£ç ç»“æ„

```text
label_converter/
â”œâ”€â”€ configs/                 # é…ç½®æ–‡ä»¶ç›®å½•
â”‚   â”œâ”€â”€ category_map.yaml    # ç±»åˆ«æ˜ å°„è¡¨ (e.g., "person" -> 0)
â”‚   â””â”€â”€ default.yaml         # å…¨å±€é»˜è®¤é…ç½®
â”œâ”€â”€ core/                    # æ ¸å¿ƒé€»è¾‘å±‚ (IR)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_model.py        # å®šä¹‰ UnifiedLabel, BBox ç­‰æ ¸å¿ƒæ•°æ®ç»“æ„
â”‚   â””â”€â”€ registry.py          # æ³¨å†Œä¸­å¿ƒï¼Œç®¡ç†æ‰€æœ‰çš„ Reader/Writer
â”œâ”€â”€ formats/                 # æ ¼å¼æ’ä»¶å±‚ (å…·ä½“å®ç°)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py              # æŠ½è±¡åŸºç±» BaseReader / BaseWriter
â”‚   â”œâ”€â”€ coco.py              # COCO æ ¼å¼å®ç°
â”‚   â”œâ”€â”€ yolo.py              # YOLO æ ¼å¼å®ç°
â”‚   â”œâ”€â”€ voc.py               # VOC XML æ ¼å¼å®ç°
â”‚   â””â”€â”€ labelme.py           # LabelMe JSON æ ¼å¼å®ç°
â”œâ”€â”€ utils/                   # å·¥å…·åº“
â”‚   â”œâ”€â”€ image_utils.py       # å›¾ç‰‡å¤„ç† (æ”¯æŒ Lazy loading è¯»å–å®½é«˜)
â”‚   â”œâ”€â”€ path_utils.py        # è·¯å¾„ä¸æ–‡ä»¶å¤„ç†
â”‚   â””â”€â”€ vis_utils.py         # è½¬æ¢ç»“æœå¯è§†åŒ–éªŒè¯å·¥å…·
â”œâ”€â”€ tests/                   # å•å…ƒæµ‹è¯• (é‡ç‚¹è¦†ç›–åæ ‡è½¬æ¢é€»è¾‘)
â”œâ”€â”€ main.py                  # ç¨‹åºç»Ÿä¸€å…¥å£
â”œâ”€â”€ requirements.txt         # ä¾èµ–åˆ—è¡¨
â””â”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡æ¡£

```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®æ–‡ä»¶å‡†å¤‡

åœ¨è½¬æ¢ YOLO ç­‰éœ€è¦çº¯æ•°å­— ID çš„æ ¼å¼æ—¶ï¼Œå¿…é¡»æä¾› `category_map.yaml`ã€‚æ ¼å¼å¦‚ä¸‹ï¼š

```yaml
# configs/category_map.yaml
{
  0: 'person',
  1: 'bicycle',
  2: 'car',
}
```

### 3. è¿è¡Œè½¬æ¢

ä½¿ç”¨ `main.py` è¿›è¡Œæ ¼å¼è½¬æ¢ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå…¸å‹çš„ä» **YOLO** è½¬æ¢åˆ° **VOC** çš„ä¾‹å­ï¼š

```bash
python main.py \
  --src-fmt yolo \
  --src-label /path/to/dataset/labels \
  --src-image /path/to/dataset/images \
  --dst-fmt voc \
  --dst-path /path/to/output \
  --category-map ./configs/category_map.yaml

```

## ğŸ› ï¸ å‚æ•°è¯´æ˜

| å‚æ•° | ç¼©å†™ | å¿…å¡« | æè¿° | ç¤ºä¾‹ |
| --- | --- | --- | --- | --- |
| `--src-fmt` | - | âœ… | æºæ•°æ®æ ¼å¼ (Supported: `yolo`, `coco`, `voc`, `labelme`) | `yolo` |
| `--src-label` | - | âœ… | æºæ ‡ç­¾æ–‡ä»¶è·¯å¾„ (æ–‡ä»¶å¤¹æˆ–å…·ä½“jsonæ–‡ä»¶) | `./data/labels/` |
| `--src-image` | - | âŒ | æºå›¾ç‰‡è·¯å¾„ (YOLO/VOC è½¬æ¢é€šå¸¸éœ€è¦è¯»å–å›¾ç‰‡å®½é«˜) | `./data/images/` |
| `--dst-fmt` | - | âœ… | ç›®æ ‡æ•°æ®æ ¼å¼ | `voc` |
| `--dst-path` | - | âœ… | è¾“å‡ºä¿å­˜è·¯å¾„ | `./output/` |
| `--category-map` | - | âŒ | ç±»åˆ«æ˜ å°„æ–‡ä»¶è·¯å¾„ (æ¶‰åŠåˆ° IDä¸Name è½¬æ¢æ—¶å¿…å¡«) | `./configs/map.yaml` |
| `--vis` | - | âŒ | æ˜¯å¦å¼€å¯å¯è§†åŒ–éªŒè¯ (ç”Ÿæˆå¸¦æ¡†å›¾ç‰‡) | `True` |

## ğŸ¤ å¦‚ä½•è´¡çŒ® (Add New Format)

å¾—ç›Šäºæ³¨å†Œæœºåˆ¶ï¼Œæ·»åŠ æ–°æ ¼å¼éå¸¸ç®€å•ï¼š

1. åœ¨ `formats/` ä¸‹æ–°å»ºæ–‡ä»¶ï¼ˆä¾‹å¦‚ `myformat.py`ï¼‰ã€‚
2. ç»§æ‰¿ `core.base` ä¸­çš„ `BaseReader` å’Œ `BaseWriter`ã€‚
3. ä½¿ç”¨è£…é¥°å™¨ `@ReaderRegistry.register('myformat')` æ³¨å†Œç±»ã€‚
4. åœ¨ `formats/__init__.py` ä¸­å¯¼å…¥è¯¥æ–‡ä»¶ã€‚

---
